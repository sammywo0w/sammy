from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.shapes import MSO_SHAPE
from pptx.dml.color import RGBColor
from pptx.enum.text import PP_ALIGN, MSO_ANCHOR

# Размер слайда (обычный 16:9)
prs = Presentation()
prs.slide_width = Inches(13.33)
prs.slide_height = Inches(7.5)

# Добавляем слайд
slide_layout = prs.slide_layouts[6]
slide = prs.slides.add_slide(slide_layout)

# Заголовок
title_shape = slide.shapes.title
if title_shape is None:
    title_shape = slide.shapes.add_textbox(Inches(0.3), Inches(0.2), Inches(12), Inches(0.5))
title_shape.text = "Business Model: business model name 1"
title_shape.text_frame.paragraphs[0].font.size = Pt(24)
title_shape.text_frame.paragraphs[0].font.bold = True

# Размеры блоков
col_width = Inches(2.1)
row_height = Inches(1.2)
start_left = Inches(0.3)
start_top = Inches(1)

# Блоки бизнес-модели
blocks = [
    ["Target Customers", "• School managers\n• another activity\n• this is a test\n• this is another test\n• This is another test\n• Independent surf schools\n• Surf instructors"],
    ["Customer Channels", "• Online advertising\n• Partnerships with surf schools\n• Social media networks"],
    ["Value Proposition", "• Streamlined class scheduling\n• Enhanced communication with students\n• Efficient teacher management"],
    ["Activities", "• Schedule surfing classes\n• Manage surf instructors\n• Track student attendance"],
    ["Resources", "• Developer team\n• Cloud server hosting\n• CRM software"],

    ["Customer Relationship", "• Customer support chat\n• In-app notifications\n• Email newsletters"],
    ["Offering", "• Surf class scheduling\n• Teacher management interface\n• Student tracking dashboard"],
    ["Partners", "• Local surf schools\n• Surf equipment suppliers\n• Surf instructor associations"],

    ["Revenue Drivers", "• Subscription fees\n• Premium features\n• Advertising partnerships\n• renting of material"],
    ["Cost Drivers", "• App development costs\n• Server maintenance\n• Marketing expenses"],
]

# Позиции (row, col, colspan)
positions = [
    (0, 0, 1), (0, 1, 1), (0, 2, 1), (0, 3, 1), (0, 4, 1),
    (1, 0, 1), (1, 1, 2), (1, 3, 1),
    (2, 0, 2), (2, 2, 3),
]

# Добавляем блоки
for (i, (row, col, colspan)) in enumerate(positions):
    width = col_width * colspan
    height = row_height
    left = start_left + col_width * col
    top = start_top + row_height * row

    shape = slide.shapes.add_shape(MSO_SHAPE.RECTANGLE, left, top, width, height)
    shape.fill.background()
    line = shape.line
    line.color.rgb = RGBColor(0, 0, 128)

    text_frame = shape.text_frame
    text_frame.clear()
    text_frame.word_wrap = True
    text_frame.margin_top = Inches(0.05)
    text_frame.margin_left = Inches(0.05)
    text_frame.margin_right = Inches(0.05)
    text_frame.vertical_anchor = MSO_ANCHOR.TOP  # Выравнивание по верхнему краю

    # Заголовок
    p = text_frame.paragraphs[0]
    run = p.add_run()
    run.text = blocks[i][0]
    run.font.bold = True
    run.font.size = Pt(10)
    p.alignment = PP_ALIGN.LEFT

    # Текст
    for line_text in blocks[i][1].split('\n'):
        p = text_frame.add_paragraph()
        run = p.add_run()
        run.text = line_text
        run.font.size = Pt(10)
        p.alignment = PP_ALIGN.LEFT

# Сохраняем
prs.save("business_model_canvas.pptx")
